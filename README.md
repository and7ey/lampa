# Плагин "Кинопоиск" для Лампы

Добавляет в приложение [Лампа](https://cub.red/lampa) список фильмов из папки "[Буду смотреть](https://www.kinopoisk.ru/mykp/folders/3575/?format=mini)" на Кинопоиске. 

## Установка

1. Откройте приложение Лампа
2. Перейдите в Настройки - Расширения
3. Выберите "Добавить плагин"
4. Укажите следующий адрес плагина
```
https://and7ey.github.io/lampa/kinopoisk.js
```
5. В приложении в меню слева выберите "Кинопоиск"
6. Перейдите на любом устройстве по ссылке https://ya.ru/device и введите код из приложения Лампа (окно "Авторизация")
7. Подождите **несколько минут** для загрузки списка фильмов

## Текущие ограничения

- Загружаются только первые 50 фильмов
- После авторизации список обновляется сразу же, при следующих входах - список актуализируется при повторном входе на экран  
- Поиск фильмов в TMDB осуществляется сначала по id кинопоиска, если ничего не нашлось, то по названию и году релиза. Есть проблемы с поиском российских фильмов
- Другие списки фильмов не поддерживаются

## Технические особенности
- Кинопоиск ограничивает доступ к данным (даже через API) через CORS Policy, потому в плагине используется CORS Proxy в виде Google Apps Script
- Данные авторизации (токен) хранятся в Local Storage браузера, выход из аккаунта возможен путем удаления этих данных (`kinopoisk_*`) или в [Управлении аккаунтом](https://passport.yandex.ru/profile/access) Яндекса
- "Опечатки" в коде наследуют наименования в исходном коде приложения Лампа: https://github.com/yumata/lampa-source

## Ошибки
Для поиска ошибок посмотрите в консоль Лампы (в левом меню Лампы выберите пункт меню "Консоль" - он находится в самом низу). Для просмотра ошибок плагина перейдите на вкладку "Кинопоиск".

<img width="1651" alt="image" src="https://github.com/user-attachments/assets/1a40f8f8-ddb1-454c-95a6-71ba49119fbb">
